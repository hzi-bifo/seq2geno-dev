dict_file       <- "seq2geno_temp/rpg_dict" # File containing the sample dictionary
anno_file       <- "annotations_for_expr.tab" # annotations of genes
out_file        <- 'test.expr.tab'
dict_file
annotation <- read.table(anno_file,header=TRUE,row.names=1)
annotation <- read.table(anno_file,header=TRUE,row.names=1, sep='\t')
annotation <- read.table(anno_file,header=TRUE,row.names=1, sep='\t', row.names= F)
annotation <- read.table(anno_file,header=TRUE, sep='\t')
head(annotation)
class(annotation$locus)
annotation <- read.table(anno_file,header=TRUE, sep='\t', stringsAsFactors=F, na.strings='.')
head(annotation)
class(annotation$locus)
dict                    <- read.table(dict_file,header=TRUE, stringsAsFactor= F, check.names= F)
nsamples                <- nrow(dict)                   # no. of samples
all_rpg                 <- matrix(0,length(annotation$gene_name),nsamples)
rownames(all_rpg)       <- rownames(annotation)
colnames(all_rpg)       <- dict$name
head(dict)
i<- 1
dict[i, ]$path
rpg             <- data.matrix(read.table(dict[i, ]$path))
head(rpg)
if(ncol(rpg) > 1){
                # two-strand mode (default setting of art2genecount.pl)
                rpg     <- as.numeric(rpg[,2])
        }
all_rpg[,i]     <- rpg
dim(all_rpg)
dim(rpg)
